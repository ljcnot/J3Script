local save_target
local target
local tclass
local this_player
local mbuff
local tbuffList
local ttarget
local ttclass
local ttbuffList
local gcdsj = 0.2 --gcdÊ±¼ä
local help = false
local lastSelectTime = 0
local isprint = true
--local youxian3 ={}
AddOption("×Ô¶¯ÇÐ²ÐÑª")
szScriptDesc = "×÷Õß£ºkeima\nËµÃ÷£º½Å±¾ËµÃ÷\nÆæÑ¨£º[Ô¨ÛÖ][·öÉ£][³ËÁú][Ò£Ë¼][·ëÒÄ][åÛÓî][ºè¹ì][Ô¾³±][ËÝ»²][Ïè¼«±ÌÂä][ñ·Â®][å£È»Èôº£]"
function ota(desc)
    local mota, motatime, motaratio = GetPrepare()
    return string.find(desc, mota)~=nil
end
function tota(desc)
    local mota, motatime, motaratio = GetPrepare(target)
    return string.find(desc, mota)~=nil
end
function totaEX()
    local mota, motatime, motaratio = GetPrepare(target)
    return motatime>0
end
function objLife(obj)
    if obj == nil then
        return 999
    end
    local bfb = (obj.nCurrentLife / obj.nMaxLife) * 100
    return bfb
end

function life()
    if this_player == nil then
        return 999
    end
    local bfb = (this_player.nCurrentLife / this_player.nMaxLife) * 100
    return bfb
end
function tlife()
    if target == nil then
        return 999
    end
    local bfb = (target.nCurrentLife / target.nMaxLife) * 100
    return bfb
end
function ttlife()
    if ttarget == nil then
        return 999
    end
    local bfb = (ttarget.nCurrentLife / ttarget.nMaxLife) * 100
    return bfb
end
function face()
    if target == nil then
        return 999
    end
    return GetFace(target)
end
function isPositive()
    return face()>=0 and face()<=15
end
function buff(list)
    mbuff = GetBuff(this_player)
    return GetBuffTime(mbuff, list) > 0
end
function tbuff(list)
    tbuffList = GetBuff(target)
    return GetBuffTime(tbuffList, list) > 0
end
function bufftime(id)
    mbuff = GetBuff(this_player)
    return GetBuffTime(mbuff, id)
end
function skill(skillid)
    --print(skillid)
    Cast(skillid, false, false)
end
function skillEX(skillid)
    ---´ò¶Ïµ±Ç°¶ÁÌõ
    CastTo(skillid,target,true)
end
function skillEX2(skillid)
    ---´ò¶Ïµ±Ç°¶ÁÌõ
    Cast(skillid,true,true)
end

function dis()
    return GetDist(target)
end
function his()
    if target == nil or  tclass == NPC then
        return 0
    end
    return GetHeight(target)
end
function mhis()
    return GetHeight(this_player)

end
function dis2()
    return GetDist2D(target)
end
function ttdis()
    return GetDist(this_player, ttarget)
end

function rseeme(seeme)
    local seemecount, seemet = GetSeeMe(20)
    return seemecount
end

function state(desc)
    local tate = GetState(this_player)
    return string.find(desc, tate)~=nil
end
function tstate(desc)
    if target == nil then
        return false
    end
    local tstate = GetState(target)
    return string.find(desc, tstate)~=nil
end
function mount(desc)
    local school = GetMount(this_player)
    ----print(school)
    return string.find(desc, school)~=nil
end
function tmount(desc)
    if tclass == NPC then
        return false
    end

    local school = GetMount(target)
    ----print(school)
    if school == nil then
        return false
    end
    return string.find(desc, school)~=nil
end

function statep(desc)
    ----print(desc)
    return GetTypeTime(mbuff, desc) > 0
end

function ttstatep(desc)
    if ttarget == nil then
        return false
    end
    return GetTypeTime(ttbuffList, desc) > 0
end

function tstatep(desc)
    if target == nil then
        return false
    end
    ----print(desc)
    return GetTypeTime(tbuffList, desc) > 0
end
function tstate(desc)
    if target == nil then
        return false
    end
    local tstate = GetState(target)
    return string.find(desc, tstate) ~= nil
end
function objState(obj, desc)
    if obj == nil then
        return false
    end
    local tstate = GetState(obj)
    return string.find(desc, tstate) ~= nil
end
function ttstate (desc)
    if ttarget == nil then
        return false
    end
    local tstate = GetState(ttarget)
    return string.find(desc, tstate) ~= nil
end
function tnostate(desc)
    if target == nil then
        return false
    end
    local tstate = GetState(target)
    return string.find(desc, tstate) == nil
end
function CastTime(skillid, time)
    if target == nil then
        return false
    end
    return GetCastTime(target, skillid) > 0 and GetCastTime(target, skillid) <= time
end
function objNotWudi(obj)
    local wudi = {203,9695,10212,9934,377}
    for k, v in ipairs(wudi) do
        if obj.IsHaveBuff(v, 0) then
            return false
        end

    end
return true
end
---È¨ÖØ¼ÆËã
function getWeight()
    --»ñÈ¡×Ô¼ºµÄbuffÊý¾Ý
    --local mbuff = GetBuff(player)
    --»ñÈ¡Ä¿±êµÄbuffÊý¾Ý
    --local tbuffList = GetBuff(target)

    local wudi = "ÕòÉ½ºÓ|Æ½É³ÂäÑã|¹í¸«Éñ¹¤|É¢Á÷Ï¼|Áý»¨|¶ÜÁ¢|ÄÏ·çÍÂÔÂ|Ð¦×í¿ñ|Ì«Ðé|Á¦Íì¿ñÀ½|Ð¥Èç»¢|Ô¡»ð|²»¶¯|Ê´ÐÄ¹Æ"
    local jianshang80 = "9696|7119|368|10307"
    --Çå¾øÓ°¸è ÂÖ»Ø ÊØÈçÉ½ Ð¦°Á¹âÒõ
    local jianshang70 = "8421|10493|1802|384"
    --¼áÈÍ ÎÞÏà¾ö ÓùÌì ×ªÇ¬À¤
    local jianshang60 = "6264|11319|8300|13044|9836|9206|6200"
    --´ºÄà»¤»¨ ÁÙÔ¨µ¸ºÓ ¶ÜÇ½ ÎÞÏà¾÷ Ä¦ßÒ Íòô¥Ö®¼Å  ÁúÐ¥¾ÅÌì
    local jianshang50 = "9810|6315|10014|8427|9803|6306|2983|1412|3068"
    --ÉáÉí ÁãÂä ¾ø¸è ÈÙ»Ô ÎÞÏà¾÷ ¹âÃ÷Ïà ÎÞÎÒ ÒÙÁ¢²»µ¹ ÎíÌå
    local jianshang40 = "9873|2953|1187|399|9693|6279|11920|8839|6637|6636|6257|5744|6163|9874|9293|12530|122|6240|12656|9208|8495|6248"
    --Ò·¹â Ê¥ÊÖÖ¯Ìì Î÷×Ú ÎÞÏà¾ö Çå¾øÓ°¸è Ì°Ä§Ìå ´ºÄà»¤»¨ Ê¥ÊÖÖ¯Ìì Ê¥ÊÖÖ¯Ìì Ê¥ÊÖÖ¯Ìì ´ºÄà»¤»¨ Ì°Ä§Ìå ÊØÈçÉ½ É¢Ó° ²ÐÓ° ³ËÁúÏ·Ë® ´ºÄà»¤»¨ ÐþË®¹Æ Ë®é¿»¨Ó¯ Íòô¥Ö®¼Å º´ÎÀ ¿Ý²Ð¹Æ
    local jianshang30 = "9510|11457|9895|9745|9896|8302|12286|2177|10051|9510|5641|6262|6160|5806|5705|2813|6247"
    --ÇàÏö·ÉÓð Ò×Ë® Ö¾³ê ³¯Ê¥ ¶ÜÎè ËàÁÐ ×óÐýÓÒ×ª Õý¹Ç ±­Ë®ÁôÓ° ÇàÏö·ÉÓð ½ð¼× ½ðÎÝ À×ÐÄ ´óÃ÷ ÉáÉí Ëæ·ç ¹ÆÓ°
    local jianshang20 = "2983|7790|7171|6378|6209|5746"
    --ÎÞÎÒ ÁúÕ½ ÉÆ»¤ Ñ±ÖÂ ÎÞÏà¾ö Á÷¹âÇôÓ°
    local jianshang10 = "11272|9904|9763|11344|6333|6610|5750|10024|12411|8424|6540|6337|6237|5770|4479|6113"
    --³õÊì µþÈª ´º´Ç ´º´Ç ÉÏ½«¾üÓ¡ ×Ýºá ¹éÈ¥À´ ¹é¼ÅµÀ ôÂôÄ ³ËÁúÏ·Ë® ¼á¶¨ ¹éÉ½ Õê»¤ Ê¥Ó¿ ÌÒ½© ÕÛ³å Ç§»úÉñËÙ
    local miankong = "ÆÐÌáÉí|ÇàÑô|Í»|ÁãÂä|Ð¦×í¿ñ|³öÔ¨|ÍÌÈÕÔÂ|ÁúÔ¾ÓÚÔ¨|¹Æ³æÏ×¼À|±ÌµûÏ×¼À|·çòÚÏ×¼À|²»¹¤|Á¦°Î|·Éð°ÖðÔÂ|ÃØÓ°|¸¡¿Õ|¸¡¿Õ|ÐÇÂ¥ÔÂÓ°|¹éº¨|ËØñÆ|³¬È»|Áé»Ô|ÉúËÀÖ®½»|ËØñÆ|Ð¥ÈÕ|ÐÇÂ¥ÔÂÓ°|×ªÇ¬À¤|×ªÇ¬À¤|Ê¥Ìå|Á÷»ð·ÉÐÇ|¿íÒ°|°ÔÌå|Ç§½ï×¹|ÐëÃÖ|ÑÌÓêÐÐ|°ÔÌå|¾ÆÖÐÏÉ|×ÝÇáÆï|ÈÎ³Û³Ò|ÉúÌ«¼«|ÉúÌ«¼«|ÐÐÌìµÀ|¹Æ³æ¿ñ±©|ËÉÑÌÖñÎí¡¤miankong|¶·ÊÒÎÞ³¾|¶·ÊÒÎÞ³¾|µ·ÒÂ|Ê¯¼äÒâ|³¾Éí|³¾Éí|ÆÆÖØÎ§|ÒôÔÏ|Ì½Ã·|µ·ÒÂ|¹ÂÓ°|¾»¹û|º´ÎÀ|½Ù»¯|Î÷³þ±¯¸è|¶ÜÇ½|¾øÂ×ÒÝÈº|Ç§µûÍÂÈð|¶ÜÒã|Ç§ÏÕ|ÎÞ¾å|ÈµÌ¤Ö¦|ÈµÌ¤Ö¦|ÈµÌ¤Ö¦|ÈµÌ¤Ö¦|ÈµÌ¤Ö¦|ÈµÌ¤Ö¦|ÈµÌ¤Ö¦|ÈµÌ¤Ö¦|ÈµÌ¤Ö¦|³¾Éí|ÆÆÔÂ|ÇàÏö·ÉÓð|¸¡¿Õ|ÇàµÙ|Ë®ÔÂÎÞ¼ä|ÕÛ¹Ç|Ê´ÐÄ¹Æ|ÓñÈªÓãÔ¾|¹ÆÓ°|ÊÉ¹Æ|ÃâÒß¿ØÖÆ|ÇàÏö·ÉÓð|¶ÝÓ°"
    local shanbi80 = "10619|9846|9783"
    --ÎíÓê|¾ªºèÓÎÁú ÈµÌ¤Ö¦
    local shanbi60 = "6434|9783|5668|9736"
    --×íåÐÒ£ ÈµÌ¤Ö¦ ·ç´µºÉ ´È±¯Ô¸

    local shanbi50 = "2065|6299|8866|677"
    --ÔÆÏ¡ËÉ Óù·ç¶øÐÐ ÈµÌ¤Ö¦ ÈµÌ¤Ö¦
    local shanbi40 = "6174|4028|10618"
    --Á½Éú Ê¥ÔÂÓÓ ÎíÓê
    local shanbi30 = "4931|6146"
    --Áú»Ú ÈÕÉý
    local shanbi20 = "4710|6142|3310|948"
    --¿õ½Ù ±ùÌì ÓÎÁú »¨ÔÂÁè·çÁùÕó
    local shanbi10 = "857|10465|6289|10617"
    --ÉÁ¶ã ÄñÏè±Ì¿Õ ´È±¯ ÎíÓê

    local fengnei = { "°ËØÔ¶´Ðþ|ÇÀÖéÊ½|ØÊÒõÖ¸|º®ÔÂÒ«|ÇåÒô³¤Ð¥|Ã·»¨Õë|ÆàÇÐ|ó¸Ð¥¶áÃü|ó¸Ð¥¿Ý²Ð|ó¸Ð¥ÃÔÐÄ|ó¸Ð¥ÃÔÐÄ|²øÖñ|½£ÆÆÐé¿Õ|³ÁÄ¬|À×öªÕðÅ­" }
    local chenmo = "À×ÔÆ|½£·É¾ªÌì|À¼´ÝÓñÕÛ|³ÁÄ¬|½£·É¾ªÌì|Ö¹Ï¢|¾®ÒÇ|³ÁÄ¬|·çÇÐ|½£ÐÄÍ¨Ã÷|ÕðÉå"
    local jianliao = "»î¼À|½ûÁÆ|Ï¢ÁÆ|Çå¾øÓ°¸è|ÐþÒ»|¶Ü»÷|µØÁú×ê|¼õÁÆ|ÉñÁú½µÊÀ|´©ÐÄåó|Åùö¨|Ð«ÕÝ|ºãºÓ½ÙÉ³|³¾Ï¢|ÍÌ³þ|°Ù×ã¶áÃü|°Ù×ã¿Ý²Ð|°Ù×ãÃÔÐÄ|³þ¼Ã|Çå¾øÓ°¸è"
    local jidao = { "¸î¾ÝÇØ¹¬|Ì¤ÑçÑïÆì|»÷µ¹" }
    local suozu = { "ÇÜÁú|¶³ÍÁ|¸î¾ÝÇØ¹¬|ÖðÐÇ¼ý|ÇÙÒô|¸´Õ÷|ÎïÎÒ|Ó°Óü|ÖÓÁÖØ¹Ðã|½£¡¤Óð|ÂäÑã|ÖÍ|Îå·½ÐÐ¾¡|Ëé±ù|°Ù×ã|Ì«ÒõÖ¸|½û¸¿|·üÒ¹¡¤²ø|Á÷¹âÇôÓ°|ÓÄÔÂ|Ê¥Ð«Ï×¼À|ë¾×ã|Ìú×¦|¿×È¸ôá|ÐäÊÖ|ÌìÖëÏ×¼À|Ó°ÖÍ|°Ù×ã¶áÃü|°Ù×ã¿Ý²Ð|°Ù×ãÃÔÐÄ|Îå·½ÐÐ¾¡|Èý²Å»¯Éú|ÍÂ¹ÊÄÉÐÂ|ÈÆ×ã|Ö¹Ë®|Ó°ºÛ|Ëø×ã" }
    local dingshen = { "²øÐÄ|µã²Ô|¶¨Éí|ÎÞÖú|°²»¼|½ðÕë|Ìì¾øµØÃð|ÃÔÓ°|´óµÀÎÞÊõ|·üÒ¹¡¤¶¨|Ë¿Ç£|»Ã¹Æ|ç­´½ÖéÐä|ËÉÌÎ|Í¬¹é|ÆÆÊÆ|Ì«ÒõÖ¸|Íê¹Ç|µÛæîÁúÏè|°ø»¨ËæÁø|Ü½ÈØ²¢µÙ|ÆßÐÇ¹°Èð|ÓàÒô|»Ã¹Æ|¶¨Éí|½£ÉñÎÞÎÒ|´óµÀÎÞÊõ" }
    local yunxuan = { "Ñ£ÔÎ|Ç§½ï×¹|²Ã¹Ç|¸î¾ÝÇØ¹¬|ÃÔÉñ¶¤|±¡·¥|¹áÄ¾Á÷»ª|ÎÞÃû»êËø|¶ÜÃÍ|¶ÜÒã|º³µØ|×íåÐÒ£|¾»ÊÀÆÆÄ§»÷|»Ã¹â²½|»¢êÚ|åó»÷|ÉÆ»¤|ÕòÄ§|·üÒ¹¡¤ÔÎ|ÖØÉË|À×Õð×Ó|ÈÕÓ°|½£³åÒõÑô|±±¶·|Ð«ÐÄ¶áÃü|Ð«ÐÄ¿Ý²Ð|Ð«ÐÄÃÔÐÄ|¶Ï»ê´Ì|±ÌÍõ|º×¹é¹ÂÉ½|Î£Â¥|×íÔÂ|µ±Í·Ò»ÇÃ|ÖÐ×¢|ÆÆ¼áÕó|Ð«¶¾Õë|ÕðÉå|´óÊ¨×Óºð|ÎåÔÌ½Ô¿Õ|Í»|Õ½ºðÑ£ÔÎ|×·»ê|ÈÕ½Ù|·å²åÔÆ¾°|±À" }
    local jiaoxie = "¸¡ÔÆ|Ï¼Á÷|²ÀÎ·°µÐÌ|½ÉÐµ"
    local youxian3 = { "²¹Ìì¾÷", "»¨¼äÓÎ", "ÏàÖª" }
    local youxian2 = { "ÄªÎÊ", "·ÙÓ°Ê¥¾ö", "¾ªÓð¾÷", "ÌìÂÞ¹îµÀ", "°ÁÑªÕ½Òâ", "×ÏÏ¼¹¦", "Ð¦³¾¾ö" }
    local youxian1 = { "Àë¾­Ò×µÀ", "ÔÆÉÑÐÄ¾­", "Ì«Ðé½£Òâ", "±ùÐÄ¾÷" }

    local weight = 10
    --OutputinGame("---------------------------------")
    if GetBuffTime(tbuffList, wudi) > 0 then
        weight = weight + 100
    end
    if tstatep("ÎÞµÐ") then		--Èç¹ûÄ¿±ê¿É¿ØÖÆ
        weight= weight +100
    end
    if tstatep("²»ËÀ") then		--Èç¹ûÄ¿±ê¿É¿ØÖÆ
        weight= weight +100
    end
    if GetBuffTime(tbuffList, wudi) > 0 then
        weight = weight + 100
    end
    if GetBuffTime(tbuffList, jianshang80) > 0 then
        weight = weight + 8
        --OutputinGame("jianshang80")
    end
    if GetBuffTime(tbuffList, jianshang70) > 0 then
        weight = weight + 7
        --OutputinGame("jianshang70")
    end
    if GetBuffTime(tbuffList, jianshang60) > 0 then
        weight = weight + 6
        --OutputinGame("jianshang60")

    end
    if GetBuffTime(tbuffList, jianshang50) > 0 then
        weight = weight + 5
        --OutputinGame("jianshang50")
    end
    if GetBuffTime(tbuffList, jianshang40) > 0 then
        weight = weight + 4
        --OutputinGame("jianshang40")
    end
    if GetBuffTime(tbuffList, jianshang30) > 0 then
        weight = weight + 3
        --OutputinGame("jianshang30")
    end
    if GetBuffTime(tbuffList, jianshang20) > 0 then
        weight = weight + 2
        --OutputinGame("jianshang20")
    end
    if GetBuffTime(tbuffList, jianshang10) > 0 then
        weight = weight + 1
        --OutputinGame("jianshang10")
    end
    if GetBuffTime(tbuffList, shanbi80) > 0 then
        weight = weight + 8
        --OutputinGame("shanbi80")
    end
    if GetBuffTime(tbuffList, shanbi60) > 0 then
        weight = weight + 6
        --OutputinGame("shanbi60")
    end
    if GetBuffTime(tbuffList, shanbi50) > 0 then
        weight = weight + 5
        --OutputinGame("shanbi50")
    end
    if GetBuffTime(tbuffList, shanbi40) > 0 then
        weight = weight + 4
        --OutputinGame("shanbi40")
    end
    if GetBuffTime(tbuffList, shanbi30) > 0 then
        weight = weight + 3
        --OutputinGame("shanbi30")
    end
    if GetBuffTime(tbuffList, shanbi20) > 0 then
        weight = weight + 2
        --OutputinGame("shanbi20")
    end
    if GetBuffTime(tbuffList, shanbi10) > 0 then
        weight = weight + 1
        --OutputinGame("shanbi10")
    end

    if GetBuffTime(tbuffList, jianliao) > 0 then
        weight = weight - 3
        --OutputinGame("shanbi10")
    end
    if tstatep("³ÁÄ¬") then		--Èç¹ûÄ¿±ê¿É¿ØÖÆ
        weight= weight -3
    end
    if tstatep("½ÉÐµ") then		--Èç¹ûÄ¿±ê¿É¿ØÖÆ
        weight= weight -3
    end
    if tstatep("·âÄÚ") then		--Èç¹ûÄ¿±ê¿É¿ØÖÆ
        weight= weight -3
    end
    if tstatep("½ûÁÆ") then		--Èç¹ûÄ¿±ê¿É¿ØÖÆ
        weight= weight -3
    end
    if tstatep("¶¨Éí") then		--Èç¹ûÄ¿±ê¿É¿ØÖÆ
        weight= weight -1
    end
    if tstatep("Ñ£ÔÎ") then		--Èç¹ûÄ¿±ê¿É¿ØÖÆ
        weight= weight -1
    end
    if tstatep("»÷µ¹") then		--Èç¹ûÄ¿±ê¿É¿ØÖÆ
        weight= weight -2
    end
    --if GetBuffTime(tbuffList,chenmo) then
    --	weight = weight -3
    --	--OutputinGame("shanbi10")
    --end
    if tlife() < 10 then
        weight = weight - 10
    end
    if tlife() >= 10 and tlife() < 20 then
        weight = weight - 9
    end
    -- Output("5")
    if tlife() >= 20 and tlife() < 30 then
        weight = weight - 8
    end
    -- Output("6")
    if tlife() >= 30 and tlife() < 40 then
        weight = weight - 7
    end
    -- Output("7")
    if tlife() >= 40 and tlife() < 50 then
        weight = weight - 6
    end
    -- Output("8")
    if tlife() >= 50 and tlife() < 60 then
        weight = weight - 5
    end
    if tlife() >= 60 and tlife() < 70 then
        weight = weight - 4
    end
    if tlife() >= 70 and tlife() < 80 then
        weight = weight - 3
    end
    if tlife() >= 80 and tlife() < 90 then
        weight = weight - 2
    end
    if tlife() >= 90 and tlife() < 100 then
        weight = weight - 1
    end

    return weight
end





--function duobi()
--	local jineng= {"À×Õð×Ó" , "ÉúËÀ½Ù" , "º³µØ" , "Ç§½ï×¹" , "¼²" , "ÆßÐÇ¹°Èð" , "ÁúÔ¾ÓÚÔ¨" , "ÁúÕ½ÓÚÒ°" , "°ô´ò¹·Í·" , "¶ÜÃÍ" , "Í»" , "½£³åÒõÑô" , "·âÔ¨ÕðÉ·" , "ÇÜÍõÁùÊ½" , "¸î¾ÝÇØ¹¬" , "¶Ï»ê´Ì" , "×íÔÂ" , "¾ªÌÎ"}
--	for key, value in ipairs(jineng)
--	do
--		if rlast(value, "µÐ¶Ô", 1) then
--			return true
--		end
--		if isme() and tlast(value, 1) then			--Èç¹ûÄ¿±êµÄÄ¿±êÊÇÎÒ
--			return true
--		end
--	end
--	return false
--end
---½ÉÐµÊ±¼ä
function jiaoxieTime()
    tbuffList = GetBuff(target)
    local time = GetTypeTime(tbuffList, "½ÉÐµ")
    if time then
        return time
    end
    return 0
end
---Ñ£ÔÎÊ±¼ä
function yunxuanTime()
    tbuffList = GetBuff(target)
    local time = GetTypeTime(tbuffList, "Ñ£ÔÎ")
    if time then
        return time
    end
    return 0
end
---¶¨ÉíÊ±¼ä
function dingshenTime()
    tbuffList = GetBuff(target)
    local time = GetTypeTime(tbuffList, "¶¨Éí")
    if time then
        return time
    end
    return 0
end
---Ëø×ãÊ±¼ä
function suozuTime()
    tbuffList = GetBuff(target)
    local time = GetTypeTime(tbuffList, "Ëø×ã")
    if time then
        return time
    end
    return 0
end
---»÷µ¹Ê±¼ä
function jidaoTime()
    tbuffList = GetBuff(target)
    local time = GetTypeTime(tbuffList, "»÷µ¹")
    if time then
        return time
    end
    return 0
end
---¼õÁÆÊ±¼ä
function jianliaoTime()
    tbuffList = GetBuff(target)
    local time = GetTypeTime(tbuffList, "¼õÁÆ")
    if time then
        return time
    end
    return 0
end
---·âÄÚÊ±¼ä
function fengneiTime()
    tbuffList = GetBuff(target)
    local time = GetTypeTime(tbuffList, "·âÄÚ")
    if time then
        return time
    end
    return 0
end
---³ÁÄ¬Ê±¼ä
function chenmoTime()
    tbuffList = GetBuff(target)
    local time = GetTypeTime(tbuffList, "³ÁÄ¬")
    if time then
        return time
    end
    return 0
end

function cdEX(skill)
    ---Í¨¹ýÒÑ¾­ÊÍ·ÅµÄ¼¼ÄÜÊ±¼äÀ´ÅÐ¶Ï¼¼ÄÜÊÇ·ñcd
    --if skill()
    --print(skill)
    return GetSkillSCD(skill) > 0
end
function cdEX2(skill)
    ---³äÄÜ¼¼ÄÜÅÐ¶Ï
    return GetSkillCN(skill)==0
end

function kongzhiTimeEX(time)
    ----print(time)
    return dingshenTime() >= time or yunxuanTime() >= time or jidaoTime() >= time
end
function jiekongTimeEX(time)
    return (dingshenTime() > 0 and dingshenTime() < time) or (yunxuanTime() > 0 and yunxuanTime() < time) or (jidaoTime() > 0 and jidaoTime() < time)
end
function jiekongTimeEX2(time)
    ---½Ó¿ÕÊ±¼ä²»´ø»÷µ¹
    return (dingshenTime() > 0 and dingshenTime() < time) or (yunxuanTime() > 0 and yunxuanTime() < time)
end
function jiekongTimeEX3(time)
    ---½Ó¿ÕÊ±¼äÖ»ÓÐ¶¨Éí
    return (dingshenTime() > 0 and dingshenTime() < time)
end
---²»ÄÜ¶ª¼¼ÄÜµÄÊ±¼ä
function noSkillTime(time)
    return (fengneiTime() > 0 and fengneiTime() > time) or (chenmoTime() > 0 and chenmoTime() > time) or (jiaoxieTime() > 0 and jiaoxieTime() > time)
end
function jiekong()
    if (GetSkillGCD("×íÔÂ") + gcdsj) > dingshenTime() then
        return false
    end
    if (GetSkillGCD("×íÔÂ") + gcdsj) > yunxuanTime() then
        return false
    end
    if (GetSkillGCD("×íÔÂ") + gcdsj) > jidaoTime() then
        return false
    end
    return true
end
function wuhuatianxing(weight)
    ---Îï»¯ÌìÐÐ
    if dis()>30 or dis()<2 or cdEX2("Îï»¯ÌìÐÐ") or (tstatep("Ãâ¿Ø") and weight>8) then
        return false
    end

    return true
end
function minghaiyubo()
    ---äéº£Óù²¨
    if dis()>8 or cdEX2("äéº£Óù²¨")   then
        return false
    end
    return true
end
function nanhaiyunming()
    ---º£ÔËÄÏÚ¤
    if   cdEX("º£ÔËÄÏÚ¤") or GetSkillCN("äéº£Óù²¨")>=2 or dis()>8  then
        return false
    end
    return true
end
function yichenbuxu()
    ---ÒÝ³¾²½Ðé
    if cdEX2("ÒÝ³¾²½Ðé") then
        return false
    end
    --if cdEX2("äéº£Óù²¨") and cdEX2("Îï»¯ÌìÐÐ") then
    --    ----print(GetCastTime(this_player,20288))
    --    return true
    --end
    --if cdEX2("Îï»¯ÌìÐÐ") and buff("13735") and GetCastTime(this_player,20285)>2 then
    --    return true
    --end
    --if cdEX2("Îï»¯ÌìÐÐ") and GetCastTime(this_player,20949)< 1 and GetCastTime(this_player,20285)>2  then
    --    return  true
    --end
    --if dis()>30 and isPositive() then
    --    return true
    --end
    if isPositive() and cdEX2("Îï»¯ÌìÐÐ")==false and GetCastTime(this_player,20949)> 0.4 and GetCastTime(this_player,20949)< 0.6 and (GetCastTime(this_player,20285)<=0 or GetCastTime(this_player,20285)>2)   then
        ----print(GetCastTime(this_player,20288))
        return true
    end
    if isPositive() and cdEX2("Îï»¯ÌìÐÐ") and buff("13735") and (GetCastTime(this_player,20285)<=0 or GetCastTime(this_player,20285)>2) then
        return true
    end
    return false
end
function shangsheng()
    if cdEX2("ÒÝ³¾²½Ðé") and cdEX2("Îï»¯ÌìÐÐ") then
        return false
    end
    ---Îï»¯ÌìÐÐ ÉÏÉý
    if cdEX("äéº£Óù²¨") or dis()>8 then
        ----print(GetCastTime(this_player,20288))
        return true
    end
    return false
end
function zhubolingyou(weight)
    ---Öð²¨ÁéÓÎ
    if dis()>5 or cdEX("Öð²¨ÁéÓÎ") or tstate("³å´Ì") or tstatep("Ãâ¿Ø") then
        return false
    end
    if weight< 8 then
        return true
    end
    if his()>8 then
        return true
    end
    return false
end
function fuyoutiandi()
    ---¸¡ÓÎÌìµØ
    if cdEX2("¸¡ÓÎÌìµØ") or buff("¸¡ÓÎÌìµØ") or (GetHeight(this_player)>10 and GetHeight(this_player)<20 ) then
        return false
    end
    return true
end
function yuechaozhanbo()
    ---Ô¾³±Õ¶²¨
    if dis()>25 then
        return false
    end
    if tstatep("Ãâ¿Ø") or tstate("³å´Ì") then
        return false
    end

    if buff("¸¡ÓÎÌìµØ") and cdEX2("¸¡ÓÎÌìµØ") and  cdEX2("Îï»¯ÌìÐÐ") and cdEX2("ÒÝ³¾²½Ðé") and buff(13735) then
        return true
    end

    if buff("¸¡ÓÎÌìµØ") ==false  then
        return true
    end
    return false
end
function muluoyangui()
    ---Ä¾ÂäÑã¹é
    if dis()>6 then
        return false
    end
    if buff("¸¡ÓÎÌìµØ") and cdEX("Ô¾³±Õ¶²¨") and buff(13735)  and cdEX2("ÒÝ³¾²½Ðé") and cdEX2("Îï»¯ÌìÐÐ") and cdEX("¸¡ÓÎÌìµØ")==false then
        return true
    end
    if buff("¸¡ÓÎÌìµØ") ==false then
        return true
    end
    return false
end
function yijueyuntian()
    ---Òí¾øÔÆÌì
    if buff("Òí¾øÔÆÌì") then
        return false
    end
    return true
end
function yuyuchifeng()
    ---Ô¦Óð³Ò·ç
    if cdEX("Ô¦Óð³Ò·ç") then
        return false
    end
    if state("Ñ£ÔÎ|¶¨Éí|ÅÀÆð") then
        return true
    end
    if buff("¸¡ÓÎÌìµØ")==false and cdEX("¸¡ÓÎÌìµØ") and mhis()>8 then
        return true
    end
    return false
end
function zhenchitunan(weight)
    ---Õñ³áÍ¼ÄÏ
    if cdEX("Õñ³áÍ¼ÄÏ") or dis()>20 then
        return false
    end
    if kongzhiTimeEX(1.5) then
        return true
    end
    if weight<5 then
        return true
    end
    return false
end
function jidianchiyu()
    ---¼²µçß³Óð
    if cdEX("¼²µçß³Óð") then
        return false
    end
    if life()<50 then
        return true
    end
    return false
end
function shuyunzhuyue()
    ---õæÔÆÖðÔÂ
    if cdEX("õæÔÆÖðÔÂ") then
        return false
    end
    if dis() > 16 then
        return true
    end
    return false
end
function xiangjibiluo()
    ---Ïè¼«±ÌÂä
    if  HaveTalent("Ïè¼«±ÌÂä")==false or cdEX("Ïè¼«±ÌÂä") then
        return false
    end
    if tstatep("Ãâ´ò¶Ï") and totaEX()  then
        return true
    end
    return false
end
function hongjianyufei(weight)
    ---ºè½¥ÓÚ·É
    if HaveTalent("ºè½¥ÓÚ·É")==false or cdEX("ºè½¥ÓÚ·É") or dis()>25 then
        return false
    end
    if buff("¸¡ÓÎÌìµØ") then
        if cdEX2("Îï»¯ÌìÐÐ") and buff(13735) then
            return true
        end
        if weight<=8 then
            return true
        end
    else
        return true
    end

return false
end
function fuyaojiutian()
    ---·öÒ¡¾ÅÌì
end
function zhanranruohai(weight)
    ---å£È»Èôº£
    if cdEX("å£È»Èôº£") or dis()>15 then
        return false
    end
    if cdEX2("Îï»¯ÌìÐÐ") and FindNpc(this_player, "³Û·çÕðÓò", 15, "×Ô¼º") and tstatep("Ãâ¿Ø")==false  and cdEX2("¸¡ÓÎÌìµØ") then
        return true
    end
    if FindNpc(this_player, "³Û·çÕðÓò", 15, "×Ô¼º") and kongzhiTimeEX(2) and cdEX2("¸¡ÓÎÌìµØ") then
        return true
    end
    if weight<=2 and cdEX2("¸¡ÓÎÌìµØ") then
        return true
    end

    return false
end
function dingbodilan()
    ---¶¨²¨íÆÀ½
    if buff("¸¡ÓÎÌìµØ") then
        return false
    end
    if cdEX("Ä¾ÂäÑã¹é") and cdEX("Ô¾³±Õ¶²¨") then
        return true
    end
    return false
end

function fly(weight)

    ---¸¡ÓÎ×´Ì¬
    if yichenbuxu() then
        skillEX(20285)
    end
    if wuhuatianxing(weight) then
        ----print("Îï»¯ÌìÐÐ")
        Cast("Îï»¯ÌìÐÐ",false,true)
    end
    if zhubolingyou(weight) then
        skillEX("Öð²¨ÁéÓÎ")
    end
    if nanhaiyunming() then
        ----print("º£ÔËÄÏÚ¤")
        skillEX("º£ÔËÄÏÚ¤")
        --return
    end
    if minghaiyubo() then
        ----print("äéº£Óù²¨")
        skillEX("äéº£Óù²¨")
        --return
    end

    if shangsheng() then
        skillEX(20949)
    end

    if zhanranruohai(weight) then
        skillEX("å£È»Èôº£")
    end
    --if hongjianyufei(weight) then
    --    skill("ºè½¥ÓÚ·É")
    --end
    if yuechaozhanbo() then
        skill("Ô¾³±Õ¶²¨")
    end
    if muluoyangui() then
        skill("Ä¾ÂäÑã¹é")
    end
end
function ground(weight)
    if mhis()<8 and buff(208) and cdEX("¸¡ÓÎÌìµØ") then
        Jump()
    end
    ---µØÃæ
    if zhanranruohai(weight) then
        skillEX("å£È»Èôº£")
    end
    if fuyoutiandi() then
        skill("¸¡ÓÎÌìµØ")
    end
    if hongjianyufei(weight) then
        skill("ºè½¥ÓÚ·É")
    end
    if yuechaozhanbo() then
        skill("Ô¾³±Õ¶²¨")
    end
    if muluoyangui() then
        skill("Ä¾ÂäÑã¹é")
    end
end
function bird(weight)
    ---Äñ
    if yijueyuntian() then
        skill("Òí¾øÔÆÌì")
    end
    if yuyuchifeng() then
        skill("Ô¦Óð³Ò·ç")
    end
    if zhenchitunan(weight) then
        skill("Õñ³áÍ¼ÄÏ")
    end
    if xiangjibiluo() then
        skill("Ïè¼«±ÌÂä")
    end
    if jidianchiyu() then
        skill("¼²µçß³Óð")
    end
end


function DPS(weight)

    bird(weight)
    if  HaveTalent("ºè½¥ÓÚ·É") then
        skill("·ÉÈÐÆÆ·ç")
        skill("·çÔÆÖØËø")
    end

    if buff("¸¡ÓÎÌìµØ") then
        fly(weight)
    else
        ground(weight)
    end



end
function toBack()
    ---×Ô¶¯ÈÆ±³
    if GetDist(target) <=2 then
        if IsBack(target) then
            MoveForwardStop()
        else
            MoveForwardStart()
        end
    end
end

function findTarget(outTarger)
    ---ÊÇ·ñÅÅ³ýµ±Ç°Ä¿±ê
    ---Ñ°ÕÒÊÊºÏµÄÄ¿±ê
    local players = GetAllPlayer()
    local lastTar = nil
    local lastWeight = 100
    for k, v in ipairs(players) do
        --vÊÇÍæ¼Ò¶ÔÏó
        local weight = 10
        if IsPlayer(v.dwID) and IsEnemy(v) and IsDangerArea(v, "µÐ¶Ô") == false and objState(v, "ÖØÉË")==false and GetDist(this_player, v) < 20 and IsVisible(this_player, v) and objNotWudi(v) then
            --Èç¹û²»ÊÇÎÒ
            if outTarger == false or v ~= target then
                ---Èç¹ûÐèÒªÅÅ³ýµ±Ç°Ä¿±ê
                if objLife(v) == 0 or objState(v, "ÖØÉË") then
                    weight = weight + 100
                end
                if objLife(v) > 80 and objLife(v) <= 90 then
                    weight = weight - 1
                end
                if objLife(v) > 70 and objLife(v) <= 80 then
                    weight = weight - 2
                end
                if objLife(v) > 60 and objLife(v) <= 70 then
                    weight = weight - 3
                end
                if objLife(v) > 50 and objLife(v) <= 60 then
                    weight = weight - 4
                end
                if objLife(v) > 40 and objLife(v) <= 50 then
                    weight = weight - 5
                end
                if objLife(v) > 30 and objLife(v) <= 40 then
                    weight = weight - 6
                end
                if objLife(v) > 20 and objLife(v) <= 30 then
                    weight = weight - 7
                end
                if objLife(v) > 10 and objLife(v) <= 20 then
                    weight = weight - 8
                end
                if objLife(v) > 0 and objLife(v) <= 10 then
                    weight = weight - 9
                end
                if objState(v, "Ñ£ÔÎ|»÷µ¹|½©Ö±|¶¨Éí") then
                    weight = weight - 3
                end
                if lastWeight > weight then
                    lastWeight = weight
                    lastTar = v
                end
            end
        end
    end
    ---Èç¹û±éÀúµÄÄ¿±ê²»µÈÓÚnil
    if lastTar ~= nil then
        SetTarget(lastTar)
    end
end
function findTargetforHp(hp)
    ---»ñÈ¡Ö¸¶¨ÑªÁ¿µÄµÐ¶ÔÄ¿±ê

    ---Ñ°ÕÒÊÊºÏµÄÄ¿±ê
    local players = GetAllPlayer()
    local lastTar = nil
    local lastWeight = 100
    for k, v in ipairs(players) do
        --vÊÇÍæ¼Ò¶ÔÏó
        local weight = 10
        if IsPlayer(v.dwID) and IsEnemy(v) and IsDangerArea(v, "µÐ¶Ô") == false and objState(v, "ÖØÉË")==false and GetDist(this_player, v) < 20 and IsVisible(this_player, v) and objLife(v) < hp and  objNotWudi(v) then
            --Èç¹û²»ÊÇÎÒ
            if objLife(v) == 0 or objState(v, "ÖØÉË") then
                weight = weight + 100
            end
            if objLife(v) > 80 and objLife(v) <= 90 then
                weight = weight - 1
            end
            if objLife(v) > 70 and objLife(v) <= 80 then
                weight = weight - 2
            end
            if objLife(v) > 60 and objLife(v) <= 70 then
                weight = weight - 3
            end
            if objLife(v) > 50 and objLife(v) <= 60 then
                weight = weight - 4
            end
            if objLife(v) > 40 and objLife(v) <= 50 then
                weight = weight - 5
            end
            if objLife(v) > 30 and objLife(v) <= 40 then
                weight = weight - 6
            end
            if objLife(v) > 20 and objLife(v) <= 30 then
                weight = weight - 7
            end
            if objLife(v) > 10 and objLife(v) <= 20 then
                weight = weight - 8
            end
            if objLife(v) > 0 and objLife(v) <= 10 then
                weight = weight - 9
            end
            if objState(v, "Ñ£ÔÎ|»÷µ¹|½©Ö±|¶¨Éí") then
                weight = weight - 3
            end
            if lastWeight > weight then
                lastWeight = weight
                lastTar = v
            end
        end
    end
    ---Èç¹û±éÀúµÄÄ¿±ê²»µÈÓÚnil
    if lastTar ~= nil then
        --print("Ñ¡Ôñ40%ÑªµÄÄ¿±ê")
        SetTarget(lastTar)
    end
end

function findTargetforRange(range)
    ---»ñÈ¡Ö¸¶¨·¶Î§ÄÚµÄµÐ¶ÔÄ¿±ê
    ---range  ·¶Î§
    if range == nil then
        return nil
    end
    ---Ñ°ÕÒÊÊºÏµÄÄ¿±ê
    local players = GetAllPlayer()
    local lastTar = nil
    local lastWeight = 100
    for k, v in ipairs(players) do
        --vÊÇÍæ¼Ò¶ÔÏó
        local weight = 10
        if IsPlayer(v.dwID) and IsEnemy(v) and objState(v, "ÖØÉË")==false  and IsDangerArea(v, "µÐ¶Ô") == false and GetDist(this_player, v) < range and IsVisible(this_player, v) and  objNotWudi(v) then
            --Èç¹û²»ÊÇÎÒ
            if objLife(v) == 0 or objState(v, "ÖØÉË") then
                weight = weight + 100
            end
            if objLife(v) > 80 and objLife(v) <= 90 then
                weight = weight - 1
            end
            if objLife(v) > 70 and objLife(v) <= 80 then
                weight = weight - 2
            end
            if objLife(v) > 60 and objLife(v) <= 70 then
                weight = weight - 3
            end
            if objLife(v) > 50 and objLife(v) <= 60 then
                weight = weight - 4
            end
            if objLife(v) > 40 and objLife(v) <= 50 then
                weight = weight - 5
            end
            if objLife(v) > 30 and objLife(v) <= 40 then
                weight = weight - 6
            end
            if objLife(v) > 20 and objLife(v) <= 30 then
                weight = weight - 7
            end
            if objLife(v) > 10 and objLife(v) <= 20 then
                weight = weight - 8
            end
            if objLife(v) > 0 and objLife(v) <= 10 then
                weight = weight - 9
            end
            if objState(v, "Ñ£ÔÎ|»÷µ¹|½©Ö±|¶¨Éí") then
                weight = weight - 3
            end
            if lastWeight > weight then
                lastWeight = weight
                lastTar = v
            end
        end
    end
    ---Èç¹û±éÀúµÄÄ¿±ê²»µÈÓÚnil
    if lastTar ~= nil then
        SetTarget(lastTar)
    end
end

function tab(weight)
    if objState(target, "ÖØÉË")  then
        findTargetforRange(30)
        --print("Ä¿±êÖØÉË")

    end
    if IsParty(target) then
        if target ~=nil then
            SetTarget(save_target)
        end
    else
        if target ~=nil then
            save_target = target
        end
    end
    if  target == nil and save_target~=nil then
        save_target = target
    end
    --if life() <=40 then
    --	local naima = FindPlayer(40, "Àë¾­Ò×µÀ|ÔÆÉÑÐÄ¾­|²¹Ìì¾÷|ÏàÖª", "¶ÓÓÑ")
    --	if naima and GetDist(naima)>6 then
    --		SetTarget(naima)
    --		help = true
    --	else
    --		if help then
    --			findTargetforRange(8)
    --			help = false
    --		end
    --	end
    --end
    --if HaveTalent("Ì½Ã·") and cdEX("Ì½Ã·") == false then
    --    ---Èç¹ûÌ½Ã·Ã»CD ²¢ÇÒÄ¿±êÊÇµÐ¶Ô
    --    local target
    --    --±éÀú¶ÓÎé³ÉÔ±
    --    for k, v in ipairs(GetAllMember()) do
    --        if IsPlayer(v.dwID) and GetDist(this_player, v) < 15 and IsVisible(this_player, v) and v~=this_player  and v.IsHaveBuff(9695, 0) == false and v.IsHaveBuff(10212, 0) == false then
    --            local tate = GetState(v)
    --            if string.find("Ñ£ÔÎ|¶¨Éí|ÅÀÆð|½©Ö±", tate) and objLife(v) < 90 then
    --                --ÏÈ±£´æµ±Ç°¶ÔÏó
    --                if ota("·çÀ´ÎâÉ½") then
    --                    CastTo("Ì½Ã·", v, true)
    --                else
    --                    CastTo("Ì½Ã·", v, false)
    --                end
    --                --print("¸øÌ½Ã·")
    --                --return 1
    --            end
    --        end
    --    end
    --end
    --if HaveTalent("ËÉÉáÎÊÏ¼") and cdEX("ËÉÉáÎÊÏ¼") == false  then
    --    ---Èç¹ûÌ½Ã·Ã»CD ²¢ÇÒÄ¿±êÊÇµÐ¶Ô
    --    local target
    --    --±éÀú¶ÓÎé³ÉÔ±
    --    for k, v in ipairs(GetAllMember()) do
    --        if IsEnemy(v.dwID) and GetDist(this_player, v) < 20 and GetHeight(v)>8 and IsVisible(this_player, v) and v~=this_player  and v.IsHaveBuff(9695, 0) == false and v.IsHaveBuff(10212, 0) == false then
    --            local tate = GetState(v)
    --            if string.find("³å´Ì", tate) == false then
    --                --ÏÈ±£´æµ±Ç°¶ÔÏó
    --                if ota("·çÀ´ÎâÉ½") then
    --                    CastTo("ËÉÉáÎÊÏ¼", v, true)
    --                else
    --                    CastTo("ËÉÉáÎÊÏ¼", v, false)
    --                end
    --                --print("ËÉÉáÎÊÏ¼")
    --                --return 1
    --            end
    --        end
    --    end
    --end
    ----print("µ±Ç°Ä¿±êÊÇ·ñÊÇ¶ÓÓÑ",IsParty(target))
    --if cdEX("Ì½Ã·") and IsParty(target) and life() >40 then
    --	if save_target ~= nil then
    --		--»»»Ø±£´æµÄÄ¿±ê
    --		SetTarget(save_target)
    --		--print("Ì½Ã·ÍêÁË,ÇÐ»ØÔ­À´Ä¿±ê")
    --
    --		return 1
    --	else
    --		findTarget(false)
    --	end
    --	--print("Ì½Ã·ÍêÁË")
    --end
    -----ÉÏ´ÎÇÐ»»Ä¿±ê´óÓÚ5Ãë²Å»á»»Ä¿±ê
    if weight>=50 and (GetTickCount() - lastSelectTime)>5000 then
        --print("Ä¿±ê¼õÉË¹ý¸ß")
        lastSelectTime = GetTickCount()
        findTarget(true)
    end

    --if IsDangerArea(target, "µÐ¶Ô") and (GetTickCount() - lastSelectTime) > 5000 then
    --    --print("Î£ÏÕÇøÓòÇÐ»»Ä¿±ê")
    --    lastSelectTime = GetTickCount()
    --    findTarget(true)
    --end
    if GetOption("×Ô¶¯ÇÐ²ÐÑª") and tlife() > 40 then
        findTargetforHp(40)
    end
end

--Mainº¯Êý£¬1¸ö²ÎÊýÊÇ×Ô¼ºµÄÍæ¼Ò¶ÔÏó£¬Ã¿Ãëµ÷ÓÃ16´Î
function Main(player)
    this_player = player
    mbuff = GetBuff(player)
    target, tclass = GetTarget(player)
    if target ~= nil then
        --if tclass == NPC then
        --    return
        --end


        tbuffList = GetBuff(target)
        ttarget, ttclass = GetTarget(target)
        if ttarget ~= nil then
            ttbuffList = GetBuff(ttarget)
        end
        local weight = getWeight()
        ----print("weight:",weight)
        tab(weight)
        if tbuff("¶ÜÁ¢") then
            StopAction()
            return
        end
        --if ota("ÔÆ·ÉÓñ»Ê") then
        --    MoveAction_StopAll()
        --    return
        --end
        ----¸úËæµ±Ç°Ä¿±ê
        --if IsDangerArea(target, "µÐ¶Ô") then
        --    MoveAction_StopAll()
        --else
            TurnTo(target)
        --    MoveForwardStart()
        --    toBack()
        --end



        --if GetHeight(player)>0 then
        --	Jump()
        --end

        --if ota("·çÀ´ÎâÉ½") then
        --    Èç¹û·ç³µ¾Í²»Ö´ÐÐºóÃæµÄ
            --return
        --end
        if cdEX("·öÒ¡Ö±ÉÏ") == false then
            Cast("·öÒ¡Ö±ÉÏ",true,false)
        end
        DPS(weight)
    end
end


--ÊÍ·Å¼¼ÄÜ»Øµ÷º¯Êý£¬ÈÎÒâ¶ÔÏóÊÍ·Å¼¼ÄÜÊ±µ÷ÓÃ
function OnCast(CasterID, dwSkillID, dwLevel, nPastFrame, tClass, tIDnX, nY, nZ)
    --CasterID ÊÍ·Å¼¼ÄÜµÄ½ÇÉ«ID
    --dwSkillID ¼¼ÄÜID
    --dwLevel ¼¼ÄÜµÈ¼¶
    --nPastFrame ´Ó·þÎñ¶Ë·¢³öµ½ÏÖÔÚÒÑ¹ýÈ¥µÄÖ¡Êý
    --tClass ¼¼ÄÜÊÍ·ÅµÄÄ¿±êÀàÐÍ(COORD, NPC, PLAYER)£¬Õâ¸öºÍ¼¼ÄÜÀàÐÍÓÐ¹Ø
    --tIDnX Èç¹ûÊÇÐèÒªÄ¿±êµÄ¼¼ÄÜ£¬Õâ¸öÊÇ¼¼ÄÜµÄÄ¿±êID£¬Èç¹ûÊÇÐèÒªÒ»¸öÎ»ÖÃÊÍ·ÅµÄ¼¼ÄÜ£¬Õâ¸öÊÇx×ø±ê
    --nY y×ø±ê£¬²»ÊÇ×ø±êÀàÐÍµÄ¼¼ÄÜÎÞÐ§
    --nZ z×ø±ê£¬²»ÊÇ×ø±êÀàÐÍµÄ¼¼ÄÜÎÞÐ§
    --±ÈÈçÓÐ¸ö¼¼ÄÜ123£¬ÀàËÆº³µØÖ®ÀàµÄ¼¼ÄÜ£¬ÆäÊµÊÇ¸ö¶þ¶Î¼¼ÄÜ£¬ÆðÌø£¬ÂäµØÖ®ºó²Å»áÔì³ÉÑ£ÔÎ
    --ÆðÌøµ½ÂäµØÓÐ8Ö¡£¨0.5Ãë£©£¬ÄãÏë¶ãÕâ¸ö¼¼ÄÜ£¨ÄôÔÆ£¬ºóÌøÊ²Ã´µÄ£©
    --local myid = GetMyID()
    --local skillList =
    --if dwSkillID == 123 and tIDnX == myid then  --Èç¹ûÊÇ¶ÔÎÒÊÍ·Å£¬Õâ¸öÊÇÆðÌø½×¶ÎµÄ¼¼ÄÜID
    --	--Èç¹û¹ýÈ¥µÄÖ¡ÊýÐ¡ÓÚ4£¬×Ü¹²8Ö¡£¬´óÓÚ4ËµÃ÷ÍøËÙÌ«²î£¬ÒÑ¾­¶ã²»µôÁË
    --	--ÕâÀïÉèÎª4Ö»ÊÇÑÝÊ¾£¬ÊµÕ½ÖÐÒª×Ô¼º³¢ÊÔ
    --	if nPastFrame < 4 then
    --		Cast(9007)  --ºóÌø
    --	end
    --end

    ----print(CasterID, dwSkillID, dwLevel, nPastFrame, tClass, tIDnX, nY, nZ)  --Êä³öÊÍ·ÅÐÅÏ¢
end


--¿ªÊ¼¶ÁÌõ»Øµ÷º¯Êý£¬ÈÎÒâ¶ÔÏó¿ªÊ¼¶ÁÌõÊ±µ÷ÓÃ
function OnPrepare(CasterID, dwSkillID, dwLevel, nLeftFrame, tClass, tIDnX, nY, nZ)

end